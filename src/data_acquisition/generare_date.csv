import pandas as pd
import numpy as np
import os

NUMAR_INTRARI = 700
FOLDER_IESIRE = 'data/raw'
NUME_FISIER = 'date_meteo.txt'
CALE_COMPLETA = os.path.join(FOLDER_IESIRE, NUME_FISIER)

def genereaza_date():
    timeline = pd.date_range(start='2024-03-01 00:00', periods=NUMAR_INTRARI, freq='H')

    np.random.seed(42)

    temp = np.random.randint(-5, 26, NUMAR_INTRARI)
    seninatate = np.random.randint(0, 101, NUMAR_INTRARI)
    vant = np.random.randint(0, 61, NUMAR_INTRARI)
    presiune = np.random.randint(990, 1031, NUMAR_INTRARI)

    df = pd.DataFrame({
        'data': timeline.strftime('%Y-%m-%d'),
        'ora': timeline.strftime('%H:%M'),
        'temperatura': temp,
        'grad_seninatate': seninatate,
        'viteza_vant': vant,
        'presiune': presiune
    })

    os.makedirs(FOLDER_IESIRE, exist_ok=True)
    
    df.to_csv(CALE_COMPLETA, sep='\t', index=False, header=False)

    print(f"Fisier generat: {CALE_COMPLETA}")
    print(df.head().to_string(index=False, header=False))

if __name__ == "__main__":
    genereaza_date()
